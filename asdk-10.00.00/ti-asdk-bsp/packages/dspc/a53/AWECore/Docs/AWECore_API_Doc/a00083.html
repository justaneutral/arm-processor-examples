<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWE Core 8.X.0 Documentation: LinuxApp.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AWE Core 8.X.0 Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">LinuxApp.c</div></div>
</div><!--header-->
<div class="contents">
<p >Examples.</p>
<p >Examples</p>
<div class="fragment"><div class="line"><span class="comment">/****************************************************************************</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      Simple AWECore Linux Application</span></div>
<div class="line"><span class="comment"> *      ---------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> ****************************************************************************</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Description:    Sample app to show basic usage of AWECore</span></div>
<div class="line"><span class="comment"> *      A single instance AWECore integration with simulated real-time audio on Linux. </span></div>
<div class="line"><span class="comment"> *      Includes an ethernet/TCPIP tuning interface to connect to AWE Server on port 15092</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      This is a low latency enabled example, meaning that there can either be 0 or 1 blocks of latency based on certain conditions...</span></div>
<div class="line"><span class="comment"> *          -If the user loads a layout with a blocksize which does NOT equal the AWEInstance&#39;s fundamental BS, there will be 1 block of latency.</span></div>
<div class="line"><span class="comment"> *          -If the user&#39;s layout blocksize matches the AWEInstance&#39;s fundamental blocksize, then there will be 0 blocks of latency</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      See the Latency section of the docs for more info. </span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright: (c) 2020 DSP Concepts, Inc. All rights reserved.</span></div>
<div class="line"><span class="comment"> *                                  3235 Kifer Road</span></div>
<div class="line"><span class="comment"> *                                  Santa Clara, CA 95054-1527</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> ***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span> </div>
<div class="line"><span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;pthread.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;semaphore.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00038.html">AWECore.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00050.html">ProxyIDs.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00041.html">AWECoreUtils.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;TargetInfo.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>ConfigParameters</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">float</span> coreSpeed;</div>
<div class="line">    <span class="keywordtype">float</span> profileSpeed;</div>
<div class="line">    <span class="keywordtype">float</span> sampleRate;</div>
<div class="line">    UINT32 fundamentalBlockSize;</div>
<div class="line">    UINT32 inChannels;</div>
<div class="line">    UINT32 outChannels;</div>
<div class="line">    UINT32 profileStatus;</div>
<div class="line">    INT32 tuningPort;</div>
<div class="line">} ConfigParameters;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Config parameters to control from app arguments</span></div>
<div class="line"><span class="keyword">static</span> ConfigParameters configParams; </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Input/output audio buffers</span></div>
<div class="line">INT32 *audioInputBuffer = NULL;</div>
<div class="line">INT32 *audioOutputBuffer = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> BOOL quiet = FALSE;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global AWEInstance structure and pins</span></div>
<div class="line"><a id="_a0" name="_a0"></a><a class="code hl_struct" href="a00071.html">AWEInstance</a> aweInstance;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> IOPinDescriptor aweInputPin;</div>
<div class="line"><span class="keyword">static</span> IOPinDescriptor aweOutputPin;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// LISTOFCLASSOBJECTS comes from ModuleList.h</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">void</span>* module_descriptor_table[] =</div>
<div class="line">{</div>
<div class="line">    LISTOFCLASSOBJECTS</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global packet buffers</span></div>
<div class="line">UINT32 awePacketBuffer[MAX_COMMAND_BUFFER_LEN];</div>
<div class="line">UINT32 awePacketBufferReply[MAX_COMMAND_BUFFER_LEN];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global heaps (dynamically allocated based on the size argument</span></div>
<div class="line">UINT32 *fastHeapA;</div>
<div class="line">UINT32 *fastHeapB;</div>
<div class="line">UINT32 *slowHeap;</div>
<div class="line">UINT32 heapSizeFastA = FASTA_HEAP_SIZE_LINUX;</div>
<div class="line">UINT32 heapSizeFastB = FASTB_HEAP_SIZE_LINUX;</div>
<div class="line">UINT32 heapSizeSlow = SLOW_HEAP_SIZE_LINUX;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global thread handles and mutexes</span></div>
<div class="line">pthread_t tuningThreadHandle;</div>
<div class="line">pthread_t processThreadHandle;</div>
<div class="line">pthread_t audioCallbackThreadHandle;</div>
<div class="line">pthread_t audioPumpAllThreadHandle;</div>
<div class="line"> </div>
<div class="line">pthread_mutex_t packetMutex;</div>
<div class="line"> </div>
<div class="line">sem_t pumpSem;</div>
<div class="line"> </div>
<div class="line">INT32 audioStarted = 0;</div>
<div class="line">INT32 exitAudioCallbackThread = 0;</div>
<div class="line"><span class="comment">// Tuning parameters</span></div>
<div class="line"><span class="keywordtype">int</span> sockfd, newsockfd;</div>
<div class="line"><span class="keywordtype">int</span> exitTuning = 0;</div>
<div class="line"> </div>
<div class="line">INT32 pumpActive = 0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// increase priority levels for AWE threads</span></div>
<div class="line"><span class="comment">// Audio callback functions must be highest priority to avoid</span></div>
<div class="line"><span class="comment">// missing real time requirements. Pump is right after,</span></div>
<div class="line"><span class="comment">// followed by tuning interface where actions can be performed</span></div>
<div class="line"><span class="comment">// in the background.</span></div>
<div class="line"><span class="preprocessor">#define AUDIO_CALLBACK_PRIO     9</span></div>
<div class="line"><span class="preprocessor">#define AUDIO_PUMP_PRIO         8</span></div>
<div class="line"><span class="preprocessor">#define TUNING_THREAD_PRIO      7</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *program)</div>
<div class="line">{</div>
<div class="line">    printf(</div>
<div class="line">        <span class="stringliteral">&quot;Usage: %s [args]\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -load:&lt;file&gt;                 AWB file to load\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -sr:sampling_rate            value in Hz, default 48KHz\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -pf:profile_frequency        value in Hz, default 10MHz\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -cf:cpu_frequency            value in Hz, default 1GHz\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -profStatus:N                set profiling status (0 - disable, 1 - enable(default), 2 - enable module level only, 3 - enable top level only)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -bsize:N                     default 32, Audio block size for the system\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -inchans:N                   default 2, number of input channels\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -outchans:N                  default 2, number of output channels\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -tport:N                     default 15002, port number for socket interface. User can choose between 15002 - 15098\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -hsizefasta:N                fast A heap size in words, default %d\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -hsizefastb:N                fast B heap size in words, default %d\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -hsizeslow:N                 slow heap size in words, default %d\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       -quiet                       works in quiet mode, displays only necessary messages\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;This program exercises the AWECore library.\n&quot;</span>,</div>
<div class="line">        program, FASTA_HEAP_SIZE_LINUX, FASTB_HEAP_SIZE_LINUX, SLOW_HEAP_SIZE_LINUX);</div>
<div class="line">        exit(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> destroyApp(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    free(audioInputBuffer);</div>
<div class="line">    free(audioOutputBuffer);</div>
<div class="line">    free(fastHeapA);</div>
<div class="line">    free(fastHeapB);</div>
<div class="line">    free(slowHeap);</div>
<div class="line">    audioInputBuffer = NULL;</div>
<div class="line">    audioOutputBuffer = NULL;</div>
<div class="line">    fastHeapA = NULL;</div>
<div class="line">    fastHeapB = NULL;</div>
<div class="line">    slowHeap = NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> error(<span class="keyword">const</span> <span class="keywordtype">char</span> *msg)</div>
<div class="line">{</div>
<div class="line">    perror(msg);</div>
<div class="line">    exit(1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> sig_handler(<span class="keywordtype">int</span> signo)</div>
<div class="line">{   </div>
<div class="line">    <span class="keywordflow">if</span> (signo == SIGINT)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Cought user termination signal</span></div>
<div class="line">        exitTuning = 1;</div>
<div class="line">        shutdown(newsockfd, SHUT_RDWR);</div>
<div class="line">        close(newsockfd);   </div>
<div class="line">        shutdown(sockfd, SHUT_RDWR);</div>
<div class="line">        close(sockfd);  </div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Wait until thread ends</span></div>
<div class="line">        pthread_join(tuningThreadHandle, NULL);</div>
<div class="line">        <span class="comment">// Destroy any app specific</span></div>
<div class="line">        destroyApp();</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Exiting LinuxApp\n&quot;</span>);</div>
<div class="line">    exit(0);    </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span>* tuningPacketThread(<span class="keywordtype">void</span>* arg)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">        Tuning packets can be recieved and processed here. Another implementation </span></div>
<div class="line"><span class="comment">        may choose to process the packet in another thread.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">    (void) arg;</div>
<div class="line">    socklen_t clilen;</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_in serv_addr, cli_addr;</div>
<div class="line">    INT32 schedPolicy, ret;</div>
<div class="line">    <span class="keyword">struct </span>sched_param schedParam;   </div>
<div class="line">    <span class="keywordtype">int</span> socketOption;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Set this thread to run at real time priority</span></div>
<div class="line">    pthread_t currentHandle = pthread_self();</div>
<div class="line">    schedParam.sched_priority = TUNING_THREAD_PRIO;</div>
<div class="line">    schedPolicy = SCHED_FIFO;</div>
<div class="line">    ret = pthread_setschedparam(currentHandle, schedPolicy, &amp;schedParam);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to increase priority of tuning thread with error: %s \nTry running with sudo\n&quot;</span>, strerror(ret));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">     </div>
<div class="line">    sockfd = socket(AF_INET, SOCK_STREAM, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (sockfd &lt; 0) </div>
<div class="line">    {</div>
<div class="line">        error(<span class="stringliteral">&quot;ERROR opening socket&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Set the socket connection option to immediately allow reuse of port upon losing connection</span></div>
<div class="line">    socketOption = 1;</div>
<div class="line">    setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;socketOption, <span class="keyword">sizeof</span>(socketOption));  </div>
<div class="line">    </div>
<div class="line">    bzero((<span class="keywordtype">char</span> *) &amp;serv_addr, <span class="keyword">sizeof</span>(serv_addr));</div>
<div class="line"> </div>
<div class="line">    serv_addr.sin_family = AF_INET;</div>
<div class="line">    serv_addr.sin_addr.s_addr = INADDR_ANY;</div>
<div class="line">    serv_addr.sin_port = htons(configParams.tuningPort);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (bind(sockfd, (<span class="keyword">struct</span> sockaddr *) &amp;serv_addr,</div>
<div class="line">              <span class="keyword">sizeof</span>(serv_addr)) &lt; 0) </div>
<div class="line">    {</div>
<div class="line">        error(<span class="stringliteral">&quot;ERROR on binding&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> (!exitTuning)</div>
<div class="line">    {</div>
<div class="line">        listen(sockfd,5);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Listening for connection on port %d\n&quot;</span>, configParams.tuningPort);</div>
<div class="line">        clilen = <span class="keyword">sizeof</span>(cli_addr);</div>
<div class="line">        newsockfd = accept(sockfd, </div>
<div class="line">                     (<span class="keyword">struct</span> sockaddr *) &amp;cli_addr, </div>
<div class="line">                     &amp;clilen);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (newsockfd &lt; 0) </div>
<div class="line">        {</div>
<div class="line">            error(<span class="stringliteral">&quot;ERROR on accept&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">          </div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Enter a tuning loop. This will be in a separate thread from audio processing */</span></div>
<div class="line">        printf( <span class="stringliteral">&quot;Found connection!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> plen;</div>
<div class="line">            ssize_t readBytes, n;</div>
<div class="line">            </div>
<div class="line">            readBytes = read(newsockfd, aweInstance.<a id="a1" name="a1"></a><a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a>, MAX_COMMAND_BUFFER_LEN * <span class="keyword">sizeof</span>(aweInstance.<a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a>[0]));</div>
<div class="line">            <span class="keywordflow">if</span> (readBytes == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// No message to read</span></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (readBytes &lt; 0) </div>
<div class="line">            {</div>
<div class="line">                error(<span class="stringliteral">&quot;ERROR reading from socket&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// May not have received the whole message. Read again if not</span></div>
<div class="line">            plen = <a id="a2" name="a2"></a><a class="code hl_define" href="a00041.html#ac6baaae3417f9751055e0dba298a80a5">PACKET_LENGTH_BYTES</a>(aweInstance.<a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a>);</div>
<div class="line">            <span class="keywordflow">while</span> (readBytes &lt; plen)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">//printf(&quot;Didn&#39;t read the entire packet! readBytes = %d, plen = %d\nReading again\n&quot;, readBytes, plen);</span></div>
<div class="line">                n = read(newsockfd,&amp;((<span class="keywordtype">char</span>*)aweInstance.<a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a>)[readBytes], MAX_COMMAND_BUFFER_LEN * <span class="keyword">sizeof</span>(aweInstance.<a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a>[0]));</div>
<div class="line">                <span class="keywordflow">if</span> (n == 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt; 0) </div>
<div class="line">                {</div>
<div class="line">                    error(<span class="stringliteral">&quot;ERROR reading from socket&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> </div>
<div class="line">                {</div>
<div class="line">                    readBytes += n;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="comment">// Don&#39;t process the packet if audio is pumping</span></div>
<div class="line">            pthread_mutex_lock(&amp;packetMutex);</div>
<div class="line">            <a id="a3" name="a3"></a><a class="code hl_function" href="a00044.html#ad4e9b6fa73ef4217ac60c80e7cb75b53">awe_packetProcess</a>(&amp;aweInstance);    </div>
<div class="line">            pthread_mutex_unlock(&amp;packetMutex);     </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">            plen = <a id="a4" name="a4"></a><a class="code hl_define" href="a00041.html#a55fe32a688d8aa99d686274bccb540f9">PACKET_LENGTH_WORDS</a>(aweInstance.<a id="a5" name="a5"></a><a class="code hl_variable" href="a00071.html#a2af7c6f45a9ea471031950713dc8a58d">pReplyBuffer</a>);</div>
<div class="line">            n = write(newsockfd, aweInstance.<a class="code hl_variable" href="a00071.html#a2af7c6f45a9ea471031950713dc8a58d">pReplyBuffer</a>, plen * <span class="keyword">sizeof</span>(aweInstance.<a class="code hl_variable" href="a00071.html#a2af7c6f45a9ea471031950713dc8a58d">pReplyBuffer</a>[0]));</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (n &lt; plen)</div>
<div class="line">            {</div>
<div class="line">                error(<span class="stringliteral">&quot;ERROR writing to socket&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span>* aweuser_pumpAllAudio(<span class="keywordtype">void</span> * args)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Represents the callback function from the audio framework</span></div>
<div class="line">    (void) args;</div>
<div class="line">    INT32 pumpMask;</div>
<div class="line">    INT32 ix;</div>
<div class="line">    INT32 i;</div>
<div class="line">    INT32 schedPolicy, ret;</div>
<div class="line">    <span class="keyword">struct </span>sched_param schedParam;      </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Set this thread to run at real time priority</span></div>
<div class="line">    pthread_t currentHandle = pthread_self();</div>
<div class="line">    schedParam.sched_priority = AUDIO_PUMP_PRIO;</div>
<div class="line">    schedPolicy = SCHED_FIFO;</div>
<div class="line">    ret = pthread_setschedparam(currentHandle, schedPolicy, &amp;schedParam);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to increase priority of audio pump thread to real time with error: %s \nTry running with sudo\n&quot;</span>, strerror(ret));</div>
<div class="line">    }   </div>
<div class="line">    </div>
<div class="line">    printf(<span class="stringliteral">&quot;Starting pump all thread\n&quot;</span>);       </div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        sem_wait(&amp;pumpSem);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Set the pumpActive global flag</span></div>
<div class="line">        pumpActive = 1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a6" name="a6"></a><a class="code hl_function" href="a00044.html#aa14f1cef3b4579e3d0aac85fe9a7c9cd">awe_layoutIsValid</a>(&amp;aweInstance) &amp;&amp; <a id="a7" name="a7"></a><a class="code hl_function" href="a00044.html#af4b5a0f5f9f869fb6e7ebeccfdd8fae3">awe_audioIsStarted</a>(&amp;aweInstance))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Import new samples</span></div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; configParams.inChannels ; i++)</div>
<div class="line">            {</div>
<div class="line">                <a id="a8" name="a8"></a><a class="code hl_function" href="a00044.html#a9e4bb98b017a47c1c1cad5e897c6390b">awe_audioImportSamples</a>(&amp;aweInstance, &amp;audioInputBuffer[i], configParams.inChannels, i, <a id="a9" name="a9"></a><a class="code hl_enumvalue" href="a00056.html#aa902d2fa9a96414950faa1cd33d02af9a8267a816f0e5d656471666befe047de3">Sample32bit</a>);</div>
<div class="line">            }</div>
<div class="line">                    </div>
<div class="line">            <span class="comment">// Pump any required sublayouts</span></div>
<div class="line">            pumpMask = <a id="a10" name="a10"></a><a class="code hl_function" href="a00044.html#ab8882c4641a4461678acfab526f61478">awe_audioGetPumpMask</a>(&amp;aweInstance);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Lock the instance so packet processing doesn&#39;t occur simultaneously</span></div>
<div class="line">            pthread_mutex_lock(&amp;packetMutex);</div>
<div class="line">            <span class="keywordflow">for</span> (ix = 0; ix &lt; NUM_THREADS; ix++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (pumpMask &amp; (1U &lt;&lt; ix))</div>
<div class="line">                {</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">// Pump the sublayout. Each pump may be in its own thread depending on the application</span></div>
<div class="line">                    ret |= <a id="a11" name="a11"></a><a class="code hl_function" href="a00044.html#a3e08c72e3bf11627e4fd87a99ebb6419">awe_audioPump</a>(&amp;aweInstance, ix);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">// Do deferred processing if needed</span></div>
<div class="line">            <span class="keywordflow">if</span> (ret &gt; 0) </div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// This could be done in a loop until ret == 0, but doing one per fundamental period </span></div>
<div class="line">                <span class="comment">// is more conservative at the cost of potentially taking longer to update a module parameter</span></div>
<div class="line">                ret = <a id="a12" name="a12"></a><a class="code hl_function" href="a00044.html#a2f78d537ec23c5222d4533de286f6349">awe_deferredSetCall</a>(&amp;aweInstance);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Export samples</span></div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; configParams.outChannels ; i++)</div>
<div class="line">            {</div>
<div class="line">                <a id="a13" name="a13"></a><a class="code hl_function" href="a00044.html#ab2a5f4c7d4228495a3af02cad79b2ee7">awe_audioExportSamples</a>(&amp;aweInstance, &amp;audioOutputBuffer[i], configParams.outChannels, i, <a class="code hl_enumvalue" href="a00056.html#aa902d2fa9a96414950faa1cd33d02af9a8267a816f0e5d656471666befe047de3">Sample32bit</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            pthread_mutex_unlock(&amp;packetMutex);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Clear the pumpActive global flag</span></div>
<div class="line">        pumpActive = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span>* audioCallbackSimulator(<span class="keywordtype">void</span> * args)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Simple real-time audio simulator. Would be ALSA, PortAudio, etc callback</span></div>
<div class="line">    <span class="comment">// Will not achieve exact realtime interrupts</span></div>
<div class="line">    <span class="keyword">struct </span>timespec ts;</div>
<div class="line">    <span class="keyword">struct </span>timespec ts_tmp;</div>
<div class="line">    <span class="keywordtype">long</span> time_nsec;</div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">long</span> accumulated_time;</div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">long</span> target_time;</div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">long</span> overshoot = 0.0; </div>
<div class="line">    (void) args;</div>
<div class="line">    INT32 schedPolicy, ret;</div>
<div class="line">    <span class="keyword">struct </span>sched_param schedParam;      </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Setup sleep time for fundamental blocksize</span></div>
<div class="line">    ts.tv_sec = 0;</div>
<div class="line">    time_nsec = (long) ((<span class="keywordtype">float</span>)1000000000L * ((float)configParams.fundamentalBlockSize / configParams.sampleRate));</div>
<div class="line">    </div>
<div class="line">    ts.tv_sec = 0;</div>
<div class="line">    ts_tmp.tv_sec = 0;</div>
<div class="line">    ts_tmp.tv_nsec = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set this thread to run at real time priority</span></div>
<div class="line">    pthread_t currentHandle = pthread_self();</div>
<div class="line">    schedParam.sched_priority = AUDIO_CALLBACK_PRIO;</div>
<div class="line">    schedPolicy = SCHED_FIFO;</div>
<div class="line">    ret = pthread_setschedparam(currentHandle, schedPolicy, &amp;schedParam);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to increase priority of audio callback thread with error: %s \nTry running with sudo\n&quot;</span>, strerror(ret));</div>
<div class="line">    }       </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> (!exitAudioCallbackThread)</div>
<div class="line">    {   </div>
<div class="line">        <span class="comment">// Check if the previous pump is active (overflow detection)</span></div>
<div class="line">        <span class="comment">// Workaround for the AWECore overflow detection failure</span></div>
<div class="line">        <span class="keywordflow">if</span> (!pumpActive)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Kick off the audio thread</span></div>
<div class="line">            sem_post(&amp;pumpSem);</div>
<div class="line">            </div>
<div class="line">            <span class="comment">// Might need to post more than once due to clock resolution </span></div>
<div class="line">            <span class="keywordflow">while</span> (overshoot &gt; time_nsec)</div>
<div class="line">            {        </div>
<div class="line">                overshoot -= time_nsec;</div>
<div class="line">                sem_post(&amp;pumpSem);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            overshoot = 0.0;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        ts.tv_nsec = time_nsec;</div>
<div class="line">        </div>
<div class="line">        clock_gettime(CLOCK_MONOTONIC, &amp;ts_tmp);</div>
<div class="line">        target_time = ((<span class="keywordtype">long</span> long)ts_tmp.tv_sec*1000000000) + ts_tmp.tv_nsec + time_nsec;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">            clock_nanosleep(CLOCK_MONOTONIC, 0, &amp;ts, NULL);</div>
<div class="line">            </div>
<div class="line">            clock_gettime(CLOCK_MONOTONIC, &amp;ts_tmp);</div>
<div class="line">            </div>
<div class="line">            accumulated_time = ((<span class="keywordtype">long</span> long)ts_tmp.tv_sec*1000000000) + ts_tmp.tv_nsec;</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (accumulated_time &gt;= target_time)</div>
<div class="line">            {</div>
<div class="line">                overshoot += (accumulated_time - target_time);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                ts.tv_nsec = (long)(target_time - accumulated_time);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">INT32 aweuser_audioStart(<a class="code hl_struct" href="a00071.html">AWEInstance</a> *pAWE)</div>
<div class="line">{</div>
<div class="line">    (void) pAWE;</div>
<div class="line">    <span class="comment">// Audio start callback. Can be used to start audio stream from audio framework.</span></div>
<div class="line">    <span class="comment">// Could be ALSA, Pulse, Jack, Portaudio, etc. </span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Kick off real-time audio simulation thread</span></div>
<div class="line">    exitAudioCallbackThread = 0;</div>
<div class="line">    pthread_create(&amp;audioCallbackThreadHandle, NULL, audioCallbackSimulator, NULL); </div>
<div class="line">    audioStarted = 1;</div>
<div class="line">    printf(<span class="stringliteral">&quot;Audio Started\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">INT32 aweuser_audioStop(<a class="code hl_struct" href="a00071.html">AWEInstance</a> *pAWE)</div>
<div class="line">{</div>
<div class="line">    (void) pAWE;</div>
<div class="line">    <span class="keywordflow">if</span>(audioCallbackThreadHandle)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Audio stop callback. Can be used to clean up audio stream.</span></div>
<div class="line"> </div>
<div class="line">        exitAudioCallbackThread = 1;</div>
<div class="line">        pthread_join(audioCallbackThreadHandle, NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (audioStarted)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Audio Stopped\n&quot;</span>);</div>
<div class="line">            audioStarted = 0;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> InitializeAWEInstance()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">    <span class="keywordtype">int</span> i, j;</div>
<div class="line">    UINT32 module_descriptor_table_size;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//set memory for awe instance and initialize to 0&#39;s</span></div>
<div class="line">    memset(&amp;aweInstance, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="a00071.html">AWEInstance</a>));</div>
<div class="line"> </div>
<div class="line">    aweInstance.<a id="a14" name="a14"></a><a class="code hl_variable" href="a00071.html#a04b44d860ec9755b807ff1c1e5769fbd">pInputPin</a> = &amp;aweInputPin;</div>
<div class="line">    aweInstance.<a id="a15" name="a15"></a><a class="code hl_variable" href="a00071.html#a5612d068da07ac3f25cf34126b0c3ee1">pOutputPin</a> = &amp;aweOutputPin;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set pointers to the separate packet buffers in this example</span></div>
<div class="line">    <span class="comment">// Could set both pointer to same buffer if desired</span></div>
<div class="line">    aweInstance.<a class="code hl_variable" href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">pPacketBuffer</a> = awePacketBuffer;</div>
<div class="line">    aweInstance.<a class="code hl_variable" href="a00071.html#a2af7c6f45a9ea471031950713dc8a58d">pReplyBuffer</a> = awePacketBufferReply;</div>
<div class="line">    </div>
<div class="line">    aweInstance.<a id="a16" name="a16"></a><a class="code hl_variable" href="a00071.html#ab625b95dee9149bb1eae3ff92eb53b2f">packetBufferSize</a> = MAX_COMMAND_BUFFER_LEN;</div>
<div class="line">    </div>
<div class="line">    aweInstance.<a id="a17" name="a17"></a><a class="code hl_variable" href="a00071.html#af1ff1dcacc3c9cc819b6f956ce79cf3f">pModuleDescriptorTable</a> = module_descriptor_table;</div>
<div class="line"> </div>
<div class="line">    module_descriptor_table_size = <span class="keyword">sizeof</span>(module_descriptor_table) / <span class="keyword">sizeof</span>(module_descriptor_table[0]); </div>
<div class="line">    aweInstance.<a id="a18" name="a18"></a><a class="code hl_variable" href="a00071.html#aeb7e2d3cb5d35f9704d968e489c4c441">numModules</a> = module_descriptor_table_size;</div>
<div class="line"> </div>
<div class="line">    aweInstance.<a id="a19" name="a19"></a><a class="code hl_variable" href="a00071.html#a440826c61772cf568281332f76871954">numThreads</a> = NUM_THREADS;</div>
<div class="line">    aweInstance.<a id="a20" name="a20"></a><a class="code hl_variable" href="a00071.html#aa69aad6195a0f3fec1e6affcd613b027">sampleRate</a> = configParams.sampleRate;</div>
<div class="line">    aweInstance.<a id="a21" name="a21"></a><a class="code hl_variable" href="a00071.html#a9cb2adbcdae20532abb84c0c7fc9e318">fundamentalBlockSize</a> = configParams.fundamentalBlockSize;</div>
<div class="line">    aweInstance.<a id="a22" name="a22"></a><a class="code hl_variable" href="a00071.html#ae210f0425f22de96f25bf36ab14ba88c">pFlashFileSystem</a> = HAS_FLASHFILESYSTEM;</div>
<div class="line"> </div>
<div class="line">    aweInstance.<a id="a23" name="a23"></a><a class="code hl_variable" href="a00071.html#af4a2203871c4688499180f87429e3d76">fastHeapASize</a> = heapSizeFastA;</div>
<div class="line">    aweInstance.<a id="a24" name="a24"></a><a class="code hl_variable" href="a00071.html#acc5c50b58381b039a7e2044863ba9444">fastHeapBSize</a> = heapSizeFastB;</div>
<div class="line">    aweInstance.<a id="a25" name="a25"></a><a class="code hl_variable" href="a00071.html#a8c37e96abcd68926d0ac6959b5dc6cd6">slowHeapSize</a> = heapSizeSlow;</div>
<div class="line">    </div>
<div class="line">    aweInstance.<a id="a26" name="a26"></a><a class="code hl_variable" href="a00071.html#afbeef773c955bfda318ca134fa40f03b">pFastHeapA</a> = fastHeapA;</div>
<div class="line">    aweInstance.<a id="a27" name="a27"></a><a class="code hl_variable" href="a00071.html#a3357ea97cbc3a98ffff830eb586dca32">pFastHeapB</a> = fastHeapB;</div>
<div class="line">    aweInstance.<a id="a28" name="a28"></a><a class="code hl_variable" href="a00071.html#aa19cf0c2c0ae9511cfe3625d3f2df53b">pSlowHeap</a> = slowHeap;</div>
<div class="line">    </div>
<div class="line">    aweInstance.<a id="a29" name="a29"></a><a class="code hl_variable" href="a00071.html#a6422edfaf98b2c9d2b8e4d61503862c3">cbAudioStart</a> = aweuser_audioStart;</div>
<div class="line">    aweInstance.<a id="a30" name="a30"></a><a class="code hl_variable" href="a00071.html#a689ac9ee605eeb9517ccfaa15679e71a">cbAudioStop</a> = aweuser_audioStop;</div>
<div class="line"> </div>
<div class="line">    aweInstance.<a id="a31" name="a31"></a><a class="code hl_variable" href="a00071.html#ae805783687d93c111f2803d6b07c7d05">coreSpeed</a> = configParams.coreSpeed;</div>
<div class="line">    aweInstance.<a id="a32" name="a32"></a><a class="code hl_variable" href="a00071.html#a1c40d7469bcb0c0b30c35d27ab7a9fb2">profileSpeed</a> = configParams.profileSpeed;</div>
<div class="line">    aweInstance.<a id="a33" name="a33"></a><a class="code hl_variable" href="a00071.html#a147fe9ce7dca2b6bcc3d86ac9b36f025">pName</a> = TARGET_NAME;</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    ret = <a id="a34" name="a34"></a><a class="code hl_function" href="a00044.html#a20d7c4aef91a7b0e190881efa67d15a7">awe_initPin</a>(&amp;aweInputPin, configParams.inChannels, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;awe_initPin inputPin failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    ret = <a class="code hl_function" href="a00044.html#a20d7c4aef91a7b0e190881efa67d15a7">awe_initPin</a>(&amp;aweOutputPin, configParams.outChannels, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;awe_initPin outputPin failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = <a id="a35" name="a35"></a><a class="code hl_function" href="a00044.html#ae4e7e278a5a4794714190415899d8022">awe_init</a>(&amp;aweInstance);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0) </div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;awe_init instance 1 failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Enable profiling (by default this is the case, but just called here to demonstrate usage)</span></div>
<div class="line">    ret = <a id="a36" name="a36"></a><a class="code hl_function" href="a00044.html#ac6a2989f2e5575d96ce9cd8baab99207">awe_setProfilingStatus</a>(&amp;aweInstance, configParams.profileStatus);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0) </div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;awe_setProfilingStatus failed with error code: %d\n&quot;</span>, ret);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef PI</span></div>
<div class="line"><span class="preprocessor">#define PI 3.141592653589793</span></div>
<div class="line"><span class="preprocessor">#endif </span></div>
<div class="line">    <span class="comment">// Fill audio input buffers with full scale sin waves</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; configParams.fundamentalBlockSize; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; configParams.inChannels; j++) </div>
<div class="line">        {</div>
<div class="line">            audioInputBuffer[i * configParams.inChannels + j] = <a id="a37" name="a37"></a><a class="code hl_function" href="a00041.html#a45fc7eb0345371558e5a7c64a49d37dc">float_to_fract32</a>(sinf(2.f*PI*(j+1)*((<span class="keywordtype">float</span>)configParams.sampleRate/configParams.fundamentalBlockSize) * (i / (<span class="keywordtype">float</span>)configParams.sampleRate)));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span>* argv[] )</div>
<div class="line">{</div>
<div class="line">    INT32 i;</div>
<div class="line">    UINT32 inSize, outSize;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *awbpath = NULL;</div>
<div class="line">    INT32 ret;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Init default configurations</span></div>
<div class="line">    configParams.fundamentalBlockSize = BASE_BLOCK_SIZE;</div>
<div class="line">    configParams.sampleRate = SAMPLE_RATE;</div>
<div class="line">    configParams.inChannels = NUM_INPUT_CHANNELS;</div>
<div class="line">    configParams.outChannels = NUM_OUTPUT_CHANNELS;</div>
<div class="line">    configParams.coreSpeed = CORE_SPEED;</div>
<div class="line">    configParams.profileSpeed = PROFILE_SPEED;</div>
<div class="line">    configParams.profileStatus = 1;</div>
<div class="line">    configParams.tuningPort = 15002;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Check if the argc == 1, meaing that there are not input parameters supplied with the program.</span></div>
<div class="line">    <span class="comment">// Print the usage information, to help the user.</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *arg = argv[i];</div>
<div class="line">    </div>
<div class="line">        <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-profStatus:&quot;</span>, 12))</div>
<div class="line">        {</div>
<div class="line">            configParams.profileStatus = atoi(arg + 12);</div>
<div class="line">            printf(<span class="stringliteral">&quot;profStatus:%u\n&quot;</span>,configParams.profileStatus);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-bsize:&quot;</span>, 7))</div>
<div class="line">        {</div>
<div class="line">            configParams.fundamentalBlockSize = atoi(arg + 7);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-bsize:     %u\n&quot;</span>,configParams.fundamentalBlockSize);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-inchans:&quot;</span>, 9))</div>
<div class="line">        {</div>
<div class="line">            configParams.inChannels = atoi(arg + 9);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-inchans:   %u\n&quot;</span>,configParams.inChannels);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-outchans:&quot;</span>, 10))</div>
<div class="line">        {</div>
<div class="line">            configParams.outChannels = atoi(arg + 10);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-outchans:  %u\n&quot;</span>,configParams.outChannels);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strncmp(arg, <span class="stringliteral">&quot;-sr:&quot;</span>, 4))</div>
<div class="line">        {</div>
<div class="line">            configParams.sampleRate = (float)atof(arg + 4);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-sr:        %f\n&quot;</span>,configParams.sampleRate);</div>
<div class="line">        }           </div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-cf:&quot;</span>, 4))</div>
<div class="line">        {</div>
<div class="line">            configParams.coreSpeed = (float)atof(arg + 4);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-cf:        %f\n&quot;</span>,configParams.coreSpeed);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-pf:&quot;</span>, 4))</div>
<div class="line">        {</div>
<div class="line">            configParams.profileSpeed = (float)atof(arg + 4);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-pf:        %f\n&quot;</span>,configParams.profileSpeed);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-tport:&quot;</span>, 7))</div>
<div class="line">        {</div>
<div class="line">            configParams.tuningPort = atoi(arg + 7);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-tport:     %d\n&quot;</span>,configParams.tuningPort);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-quiet&quot;</span>, 6))</div>
<div class="line">        {</div>
<div class="line">            quiet = TRUE;</div>
<div class="line">            printf(<span class="stringliteral">&quot;-quiet:     %d\n&quot;</span>,quiet);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-hsizefasta:&quot;</span>, 12))</div>
<div class="line">        {</div>
<div class="line">            heapSizeFastA = atoi(arg + 12);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-hsizefasta:     %u\n&quot;</span>,heapSizeFastA);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-hsizefastb:&quot;</span>, 12))</div>
<div class="line">        {</div>
<div class="line">            heapSizeFastB = atoi(arg + 12);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-hsizefastb:     %u\n&quot;</span>,heapSizeFastB);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-hsizeslow:&quot;</span>, 11))</div>
<div class="line">        {</div>
<div class="line">            heapSizeSlow = atoi(arg + 11);</div>
<div class="line">            printf(<span class="stringliteral">&quot;-hsizeslow:      %u\n&quot;</span>,heapSizeSlow);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(arg, <span class="stringliteral">&quot;-load:&quot;</span>, 6))</div>
<div class="line">        {</div>
<div class="line">            awbpath = arg + 6;</div>
<div class="line">            printf(<span class="stringliteral">&quot;-load:           %s\n&quot;</span>,awbpath);        </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            usage(argv[0]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!quiet)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;\nAWECore initialised with the following parameters\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-cf:             %f Hz\n&quot;</span>,configParams.coreSpeed);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-pf:             %f Hz\n&quot;</span>,configParams.profileSpeed);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-sr:             %f Hz\n&quot;</span>,configParams.sampleRate);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-bsize:          %u\n&quot;</span>,configParams.fundamentalBlockSize);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-inchans:        %u\n&quot;</span>,configParams.inChannels);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-outchans:       %u\n&quot;</span>,configParams.outChannels);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-tport:          %d\n&quot;</span>,configParams.tuningPort);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-hsizefasta:     %u\n&quot;</span>,heapSizeFastA);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-hsizefastb:     %u\n&quot;</span>,heapSizeFastB);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-hsizeslow:      %u\n&quot;</span>,heapSizeSlow);</div>
<div class="line">        printf(<span class="stringliteral">&quot;-load:           %s\n&quot;</span>,awbpath ? awbpath : <span class="stringliteral">&quot;undefined&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (configParams.profileStatus)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;-profStatus: Profiling is enabled\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> </div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;-profStatus: Profiling is disabled\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Setup signal handler to kill sockets</span></div>
<div class="line">    <span class="keywordflow">if</span> (signal(SIGINT, sig_handler) == SIG_ERR)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Can&#39;t catch SIGINT (%d)\n&quot;</span>, SIGINT);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Allocate the input and output buffers</span></div>
<div class="line">    inSize = configParams.inChannels * configParams.fundamentalBlockSize;</div>
<div class="line">    outSize = configParams.outChannels * configParams.fundamentalBlockSize;</div>
<div class="line"> </div>
<div class="line">    audioInputBuffer = malloc(inSize * <span class="keyword">sizeof</span>(INT32));</div>
<div class="line">    audioOutputBuffer = malloc(outSize * <span class="keyword">sizeof</span>(INT32));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Allocate heaps</span></div>
<div class="line">    fastHeapA = malloc(heapSizeFastA * <span class="keyword">sizeof</span>(UINT32));</div>
<div class="line">    fastHeapB = malloc(heapSizeFastB * <span class="keyword">sizeof</span>(UINT32));</div>
<div class="line">    slowHeap  = malloc(heapSizeSlow  * <span class="keyword">sizeof</span>(UINT32));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Initialize the AWEInstance</span></div>
<div class="line">    InitializeAWEInstance();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ( NULL != awbpath )</div>
<div class="line">    {</div>
<div class="line">        FILE *fin;</div>
<div class="line">        UINT32 position;</div>
<div class="line">        fin = fopen(awbpath, <span class="stringliteral">&quot;rb&quot;</span>);     </div>
<div class="line">        <span class="keywordflow">if</span> (NULL == fin )</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error opening input file %s\n&quot;</span>, awbpath);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Please check the path\n&quot;</span>);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//Load the AWB from the file</span></div>
<div class="line">        ret = <a id="a38" name="a38"></a><a class="code hl_function" href="a00044.html#ad9e1b4dbbf941d7e14dae2418223c3e7">awe_loadAWBfromFile</a>(&amp;aweInstance, awbpath, &amp;position);</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a39" name="a39"></a><a class="code hl_define" href="a00047.html#ad1a31c5316d5f51ca5c1c4fb2b9b1958">E_SUCCESS</a> == ret) </div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;The layout %s loaded successfully\n&quot;</span>, awbpath);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> </div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;The layout %s download unsuccessful in the positions %u with Error = %d \n&quot;</span>, awbpath, position, ret);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize mutex and condition variable objects</span></div>
<div class="line">    pthread_mutex_init(&amp;packetMutex, NULL);</div>
<div class="line"> </div>
<div class="line">    sem_init(&amp;pumpSem, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Start tuning thread</span></div>
<div class="line">    pthread_create(&amp;tuningThreadHandle, NULL, tuningPacketThread, NULL); </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Start audio pump all thread</span></div>
<div class="line">    pthread_create(&amp;audioPumpAllThreadHandle, NULL, aweuser_pumpAllAudio, NULL); </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait until all threads end</span></div>
<div class="line">    pthread_join(tuningThreadHandle, NULL);</div>
<div class="line">    </div>
<div class="line">    pthread_join(audioPumpAllThreadHandle, NULL);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aa00038_html"><div class="ttname"><a href="a00038.html">AWECore.h</a></div><div class="ttdoc">The AWECore API Header File.</div></div>
<div class="ttc" id="aa00041_html"><div class="ttname"><a href="a00041.html">AWECoreUtils.h</a></div><div class="ttdoc">The AWECore Helper Functions File.</div></div>
<div class="ttc" id="aa00041_html_a45fc7eb0345371558e5a7c64a49d37dc"><div class="ttname"><a href="a00041.html#a45fc7eb0345371558e5a7c64a49d37dc">float_to_fract32</a></div><div class="ttdeci">INT32 float_to_fract32(FLOAT32 x)</div><div class="ttdoc">Convert audio data from floating point to Fract32 sample by sample.</div></div>
<div class="ttc" id="aa00041_html_a55fe32a688d8aa99d686274bccb540f9"><div class="ttname"><a href="a00041.html#a55fe32a688d8aa99d686274bccb540f9">PACKET_LENGTH_WORDS</a></div><div class="ttdeci">#define PACKET_LENGTH_WORDS(x)</div><div class="ttdoc">This will determine the length of a packet in words.</div><div class="ttdef"><b>Definition:</b> AWECoreUtils.h:40</div></div>
<div class="ttc" id="aa00041_html_ac6baaae3417f9751055e0dba298a80a5"><div class="ttname"><a href="a00041.html#ac6baaae3417f9751055e0dba298a80a5">PACKET_LENGTH_BYTES</a></div><div class="ttdeci">#define PACKET_LENGTH_BYTES(x)</div><div class="ttdoc">This will determine the length of a packet in bytes.</div><div class="ttdef"><b>Definition:</b> AWECoreUtils.h:43</div></div>
<div class="ttc" id="aa00044_html_a20d7c4aef91a7b0e190881efa67d15a7"><div class="ttname"><a href="a00044.html#a20d7c4aef91a7b0e190881efa67d15a7">awe_initPin</a></div><div class="ttdeci">INT32 awe_initPin(IOPinDescriptor *pPin, UINT32 channels, const char *name)</div><div class="ttdoc">Initialize an input or output pin.</div></div>
<div class="ttc" id="aa00044_html_a2f78d537ec23c5222d4533de286f6349"><div class="ttname"><a href="a00044.html#a2f78d537ec23c5222d4533de286f6349">awe_deferredSetCall</a></div><div class="ttdeci">INT32 awe_deferredSetCall(AWEInstance *pAWE)</div><div class="ttdoc">Perform deferred awe set on a module.</div></div>
<div class="ttc" id="aa00044_html_a3e08c72e3bf11627e4fd87a99ebb6419"><div class="ttname"><a href="a00044.html#a3e08c72e3bf11627e4fd87a99ebb6419">awe_audioPump</a></div><div class="ttdeci">INT32 awe_audioPump(AWEInstance *pAWE, UINT32 layoutIndex)</div><div class="ttdoc">Audio pump function.</div></div>
<div class="ttc" id="aa00044_html_a9e4bb98b017a47c1c1cad5e897c6390b"><div class="ttname"><a href="a00044.html#a9e4bb98b017a47c1c1cad5e897c6390b">awe_audioImportSamples</a></div><div class="ttdeci">INT32 awe_audioImportSamples(const AWEInstance *pAWE, const void *inSamples, INT32 inStride, INT32 channel, SampleType inType)</div><div class="ttdoc">Import samples from a user buffer to a channel.</div></div>
<div class="ttc" id="aa00044_html_aa14f1cef3b4579e3d0aac85fe9a7c9cd"><div class="ttname"><a href="a00044.html#aa14f1cef3b4579e3d0aac85fe9a7c9cd">awe_layoutIsValid</a></div><div class="ttdeci">INT32 awe_layoutIsValid(const AWEInstance *pAWE)</div><div class="ttdoc">Determines if a layout is loaded and valid.</div></div>
<div class="ttc" id="aa00044_html_ab2a5f4c7d4228495a3af02cad79b2ee7"><div class="ttname"><a href="a00044.html#ab2a5f4c7d4228495a3af02cad79b2ee7">awe_audioExportSamples</a></div><div class="ttdeci">INT32 awe_audioExportSamples(const AWEInstance *pAWE, void *outSamples, INT32 outStride, INT32 channel, SampleType outType)</div><div class="ttdoc">Export samples to a user buffer from a channel.</div></div>
<div class="ttc" id="aa00044_html_ab8882c4641a4461678acfab526f61478"><div class="ttname"><a href="a00044.html#ab8882c4641a4461678acfab526f61478">awe_audioGetPumpMask</a></div><div class="ttdeci">INT32 awe_audioGetPumpMask(AWEInstance *pAWE)</div><div class="ttdoc">Test if AWE is ready to run.</div></div>
<div class="ttc" id="aa00044_html_ac6a2989f2e5575d96ce9cd8baab99207"><div class="ttname"><a href="a00044.html#ac6a2989f2e5575d96ce9cd8baab99207">awe_setProfilingStatus</a></div><div class="ttdeci">INT32 awe_setProfilingStatus(AWEInstance *pAWE, UINT32 status)</div><div class="ttdoc">Enable or disable the profiling ability of the AWE Core.</div></div>
<div class="ttc" id="aa00044_html_ad4e9b6fa73ef4217ac60c80e7cb75b53"><div class="ttname"><a href="a00044.html#ad4e9b6fa73ef4217ac60c80e7cb75b53">awe_packetProcess</a></div><div class="ttdeci">INT32 awe_packetProcess(AWEInstance *pAWE)</div><div class="ttdoc">Process an AWEInstance's newly received tuning packet.</div></div>
<div class="ttc" id="aa00044_html_ad9e1b4dbbf941d7e14dae2418223c3e7"><div class="ttname"><a href="a00044.html#ad9e1b4dbbf941d7e14dae2418223c3e7">awe_loadAWBfromFile</a></div><div class="ttdeci">INT32 awe_loadAWBfromFile(AWEInstance *pAWE, const char *binaryFile, UINT32 *pPos)</div><div class="ttdoc">Load an AWB file from stdio.</div></div>
<div class="ttc" id="aa00044_html_ae4e7e278a5a4794714190415899d8022"><div class="ttname"><a href="a00044.html#ae4e7e278a5a4794714190415899d8022">awe_init</a></div><div class="ttdeci">INT32 awe_init(AWEInstance *pAWE)</div><div class="ttdoc">Initialize the instance.</div></div>
<div class="ttc" id="aa00044_html_af4b5a0f5f9f869fb6e7ebeccfdd8fae3"><div class="ttname"><a href="a00044.html#af4b5a0f5f9f869fb6e7ebeccfdd8fae3">awe_audioIsStarted</a></div><div class="ttdeci">INT32 awe_audioIsStarted(const AWEInstance *pAWE)</div><div class="ttdoc">Check if this instance is running.</div></div>
<div class="ttc" id="aa00047_html_ad1a31c5316d5f51ca5c1c4fb2b9b1958"><div class="ttname"><a href="a00047.html#ad1a31c5316d5f51ca5c1c4fb2b9b1958">E_SUCCESS</a></div><div class="ttdeci">#define E_SUCCESS</div><div class="ttdoc">OK result.</div><div class="ttdef"><b>Definition:</b> Errors.h:31</div></div>
<div class="ttc" id="aa00050_html"><div class="ttname"><a href="a00050.html">ProxyIDs.h</a></div><div class="ttdoc">A list of all AWE Server Commands.</div></div>
<div class="ttc" id="aa00056_html_aa902d2fa9a96414950faa1cd33d02af9a8267a816f0e5d656471666befe047de3"><div class="ttname"><a href="a00056.html#aa902d2fa9a96414950faa1cd33d02af9a8267a816f0e5d656471666befe047de3">Sample32bit</a></div><div class="ttdeci">@ Sample32bit</div><div class="ttdoc">Data is 32 bit PCM .</div><div class="ttdef"><b>Definition:</b> StandardDefs.h:231</div></div>
<div class="ttc" id="aa00071_html"><div class="ttname"><a href="a00071.html">_AWEInstance</a></div><div class="ttdoc">The AWE instance.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:45</div></div>
<div class="ttc" id="aa00071_html_a04b44d860ec9755b807ff1c1e5769fbd"><div class="ttname"><a href="a00071.html#a04b44d860ec9755b807ff1c1e5769fbd">_AWEInstance::pInputPin</a></div><div class="ttdeci">IOPinDescriptor * pInputPin</div><div class="ttdoc">A BSP author must define/allocate an input pin in their BSP and assign it to this member NOTE: AudioW...</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:103</div></div>
<div class="ttc" id="aa00071_html_a147fe9ce7dca2b6bcc3d86ac9b36f025"><div class="ttname"><a href="a00071.html#a147fe9ce7dca2b6bcc3d86ac9b36f025">_AWEInstance::pName</a></div><div class="ttdeci">const char * pName</div><div class="ttdoc">The name of the AWE Instance that will be displayed in Server.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:172</div></div>
<div class="ttc" id="aa00071_html_a1c40d7469bcb0c0b30c35d27ab7a9fb2"><div class="ttname"><a href="a00071.html#a1c40d7469bcb0c0b30c35d27ab7a9fb2">_AWEInstance::profileSpeed</a></div><div class="ttdeci">float profileSpeed</div><div class="ttdoc">Profiling clock speed in Hz.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:164</div></div>
<div class="ttc" id="aa00071_html_a2af7c6f45a9ea471031950713dc8a58d"><div class="ttname"><a href="a00071.html#a2af7c6f45a9ea471031950713dc8a58d">_AWEInstance::pReplyBuffer</a></div><div class="ttdeci">UINT32 * pReplyBuffer</div><div class="ttdoc">Reply buffer pointer.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:146</div></div>
<div class="ttc" id="aa00071_html_a3357ea97cbc3a98ffff830eb586dca32"><div class="ttname"><a href="a00071.html#a3357ea97cbc3a98ffff830eb586dca32">_AWEInstance::pFastHeapB</a></div><div class="ttdeci">UINT32 * pFastHeapB</div><div class="ttdoc">The second fast heap, B .</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:57</div></div>
<div class="ttc" id="aa00071_html_a440826c61772cf568281332f76871954"><div class="ttname"><a href="a00071.html#a440826c61772cf568281332f76871954">_AWEInstance::numThreads</a></div><div class="ttdeci">UINT32 numThreads</div><div class="ttdoc">Number of threads supported for multithreaded systems(1-4).</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:176</div></div>
<div class="ttc" id="aa00071_html_a5612d068da07ac3f25cf34126b0c3ee1"><div class="ttname"><a href="a00071.html#a5612d068da07ac3f25cf34126b0c3ee1">_AWEInstance::pOutputPin</a></div><div class="ttdeci">IOPinDescriptor * pOutputPin</div><div class="ttdoc">A BSP author must define/allocate an output pin in their BSP and assign it to this member NOTE: Audio...</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:109</div></div>
<div class="ttc" id="aa00071_html_a5b01cf1b8e8a280bbf3f7f948f54f74b"><div class="ttname"><a href="a00071.html#a5b01cf1b8e8a280bbf3f7f948f54f74b">_AWEInstance::pPacketBuffer</a></div><div class="ttdeci">UINT32 * pPacketBuffer</div><div class="ttdoc">The Packet buffer pointer.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:137</div></div>
<div class="ttc" id="aa00071_html_a6422edfaf98b2c9d2b8e4d61503862c3"><div class="ttname"><a href="a00071.html#a6422edfaf98b2c9d2b8e4d61503862c3">_AWEInstance::cbAudioStart</a></div><div class="ttdeci">INT32(* cbAudioStart)(struct _AWEInstance *PAWE)</div><div class="ttdoc">OPTIONAL This callback is invoked when a layout is run or when a StartAudio command is sent.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:79</div></div>
<div class="ttc" id="aa00071_html_a689ac9ee605eeb9517ccfaa15679e71a"><div class="ttname"><a href="a00071.html#a689ac9ee605eeb9517ccfaa15679e71a">_AWEInstance::cbAudioStop</a></div><div class="ttdeci">INT32(* cbAudioStop)(struct _AWEInstance *pAWE)</div><div class="ttdoc">OPTIONAL.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:85</div></div>
<div class="ttc" id="aa00071_html_a8c37e96abcd68926d0ac6959b5dc6cd6"><div class="ttname"><a href="a00071.html#a8c37e96abcd68926d0ac6959b5dc6cd6">_AWEInstance::slowHeapSize</a></div><div class="ttdeci">UINT32 slowHeapSize</div><div class="ttdoc">The slow heap size.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:71</div></div>
<div class="ttc" id="aa00071_html_a9cb2adbcdae20532abb84c0c7fc9e318"><div class="ttname"><a href="a00071.html#a9cb2adbcdae20532abb84c0c7fc9e318">_AWEInstance::fundamentalBlockSize</a></div><div class="ttdeci">UINT32 fundamentalBlockSize</div><div class="ttdoc">Base frame size of this instance.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:183</div></div>
<div class="ttc" id="aa00071_html_aa19cf0c2c0ae9511cfe3625d3f2df53b"><div class="ttname"><a href="a00071.html#aa19cf0c2c0ae9511cfe3625d3f2df53b">_AWEInstance::pSlowHeap</a></div><div class="ttdeci">UINT32 * pSlowHeap</div><div class="ttdoc">The slow heap.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:60</div></div>
<div class="ttc" id="aa00071_html_aa69aad6195a0f3fec1e6affcd613b027"><div class="ttname"><a href="a00071.html#aa69aad6195a0f3fec1e6affcd613b027">_AWEInstance::sampleRate</a></div><div class="ttdeci">float sampleRate</div><div class="ttdoc">Default sample rate of this instance.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:179</div></div>
<div class="ttc" id="aa00071_html_ab625b95dee9149bb1eae3ff92eb53b2f"><div class="ttname"><a href="a00071.html#ab625b95dee9149bb1eae3ff92eb53b2f">_AWEInstance::packetBufferSize</a></div><div class="ttdeci">UINT32 packetBufferSize</div><div class="ttdoc">Packet buffer size.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:153</div></div>
<div class="ttc" id="aa00071_html_acc5c50b58381b039a7e2044863ba9444"><div class="ttname"><a href="a00071.html#acc5c50b58381b039a7e2044863ba9444">_AWEInstance::fastHeapBSize</a></div><div class="ttdeci">UINT32 fastHeapBSize</div><div class="ttdoc">The fast heap B size.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:68</div></div>
<div class="ttc" id="aa00071_html_ae210f0425f22de96f25bf36ab14ba88c"><div class="ttname"><a href="a00071.html#ae210f0425f22de96f25bf36ab14ba88c">_AWEInstance::pFlashFileSystem</a></div><div class="ttdeci">AWEFlashFSInstance * pFlashFileSystem</div><div class="ttdoc">DSPC Flash file system instance.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:188</div></div>
<div class="ttc" id="aa00071_html_ae805783687d93c111f2803d6b07c7d05"><div class="ttname"><a href="a00071.html#ae805783687d93c111f2803d6b07c7d05">_AWEInstance::coreSpeed</a></div><div class="ttdeci">float coreSpeed</div><div class="ttdoc">A BSP author will set this to the speed of the CPU they are integrating into.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:161</div></div>
<div class="ttc" id="aa00071_html_aeb7e2d3cb5d35f9704d968e489c4c441"><div class="ttname"><a href="a00071.html#aeb7e2d3cb5d35f9704d968e489c4c441">_AWEInstance::numModules</a></div><div class="ttdeci">UINT32 numModules</div><div class="ttdoc">Number of modules in module table.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:119</div></div>
<div class="ttc" id="aa00071_html_af1ff1dcacc3c9cc819b6f956ce79cf3f"><div class="ttname"><a href="a00071.html#af1ff1dcacc3c9cc819b6f956ce79cf3f">_AWEInstance::pModuleDescriptorTable</a></div><div class="ttdeci">const ModClassModule ** pModuleDescriptorTable</div><div class="ttdoc">Pointer to module table.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:127</div></div>
<div class="ttc" id="aa00071_html_af4a2203871c4688499180f87429e3d76"><div class="ttname"><a href="a00071.html#af4a2203871c4688499180f87429e3d76">_AWEInstance::fastHeapASize</a></div><div class="ttdeci">UINT32 fastHeapASize</div><div class="ttdoc">The fast heap A size in 32-bit words.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:65</div></div>
<div class="ttc" id="aa00071_html_afbeef773c955bfda318ca134fa40f03b"><div class="ttname"><a href="a00071.html#afbeef773c955bfda318ca134fa40f03b">_AWEInstance::pFastHeapA</a></div><div class="ttdeci">UINT32 * pFastHeapA</div><div class="ttdoc">Fast heap A.</div><div class="ttdef"><b>Definition:</b> AWEInstance.h:54</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
