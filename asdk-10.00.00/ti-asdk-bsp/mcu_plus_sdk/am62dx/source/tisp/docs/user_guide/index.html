<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>TISP User Guide: TISP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TISP User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceTISP.html">TISP</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section attention"><dt>Attention</dt><dd><ul>
<li>Features listed below are early versions and should be considered as "experimental".</li>
<li>Users can evaluate the feature, however the feature is not fully tested at TI side.</li>
<li>TI would not support these feature on public e2e.</li>
<li>Experimental features will be enabled with limited examples and SW modules.</li>
</ul>
</dd></dl>
<p><a class="el" href="namespaceTISP.html">TISP</a> (TI signal processing) is a software library that strives to abstract away the software and the hardware complexity of programming the C7x.</p>
<h1><a class="anchor" id="Intro"></a>
Introduction</h1>
<p>A typical signal chain is shown in the figure below. Basically, a collection of kernels (nodes) stitched together. A set of these kernels in the signal chain are grouped for DMA (supernode). Typically, in user applications, the complete data needs to be processed by nodes encapsulated inside the supernode before calling the next node in the signal chain. Nodes (kernels) themselves perform compute using data in L2SRAM. Data movement from DDR to L2SRAM (DMA) is accomplished via DRU (data routing unit) available within the C7x. </p><div class="image">
<object type="image/svg+xml" data="typical_signal_chain.svg" width="500px" style="pointer-events: none;"></object>
<div class="caption">
Typical Signal Chain</div></div>
<h1><a class="anchor" id="node"></a>
Node-level Abstraction</h1>
<p>In order to create a common baseline for kernels from various libraries, we first create a virtual class <a class="el" href="classTISP_1_1virtualOp.html">TISP::virtualOp</a>. Doing so, allows us to create a class for every kernel in a given library that is derived from the base virtual class <a class="el" href="classTISP_1_1virtualOp.html">TISP::virtualOp</a>. Please note that node-level abstraction is not available for all kernels of a given library. Please refer to <a class="el" href="group__dsplibNode.html">DSPLIB Nodes</a> for supported nodes.</p>
<div class="image">
<object type="image/svg+xml" data="node-level_abstraction.svg" style="pointer-events: none;"></object>
<div class="caption">
Node-Level Abstraction</div></div>
<p>Employing this methodology enables us to string a bunch of nodes together through a custom vector datatype, <a class="el" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a>. An example of the matrix transpose kernel from DSPLIB described as a class <a class="el" href="classTISP_1_1DSPLIB_1_1matTrans.html">TISP::DSPLIB::matTrans</a> is shown below. Please refer to the DSPLIB documentation for more details about the data structures pertaining to DSPLIB.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, dmaDir_t dmaDir&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;matTrans&lt;T, dmaDir&gt;::matTrans(T *_pX, T *_pY, <span class="keywordtype">size_t</span> _width, <span class="keywordtype">size_t</span> _height, <span class="keywordtype">size_t</span> _inPitch, <span class="keywordtype">size_t</span> _outPitch)</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    : pX(_pX), pY(_pY)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   /***********************************************************************/</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;   <span class="comment">/* Initialize data structures required by DSPLIB_matrTrans from DSPLIB */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   /***********************************************************************/</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   DSPLIB_matTransInitArgs kerInitArgs;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   kerInitArgs.dimX      = _width;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   kerInitArgs.dimY      = _height;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   kerInitArgs.funcStyle = DSPLIB_FUNCTION_OPTIMIZED;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   int32_t handleSize = DSPLIB_matTrans_getHandleSize(&amp;kerInitArgs);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   handle             = memalign(128, handleSize);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   DSPLIB_bufParams2D_t bufParamsIn, bufParamsOut;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   bufParamsIn.data_type = <a class="code" href="structDSPLIB__element__dType.html">DSPLIB_element_dType&lt;T&gt;::value</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   bufParamsIn.dim_x     = _width;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   bufParamsIn.dim_y     = _height;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   bufParamsIn.stride_y  = _inPitch;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   bufParamsOut.data_type = <a class="code" href="structDSPLIB__element__dType.html">DSPLIB_element_dType&lt;T&gt;::value</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   bufParamsOut.dim_x     = _height;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   bufParamsOut.dim_y     = _width;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   bufParamsOut.stride_y  = _outPitch;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">   /******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="comment">/* Call init function from DSPLIB to for matrix transpose to set SE/SA params */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">   /******************************************************************************/</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   DSPLIB_matTrans_init(handle, &amp;bufParamsIn, &amp;bufParamsOut, &amp;kerInitArgs);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">   /***************************************************/</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="comment">/* Set pingPong offsets and flags to default value */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">   /***************************************************/</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   pingPongOffsetIn  = (_height * _inPitch) / <span class="keyword">sizeof</span>(T);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   pingPongOffsetOut = (_width * _outPitch) / <span class="keyword">sizeof</span>(T);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   pingPongFlagIn  = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   pingPongFlagOut = 0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="ttc" id="astructDSPLIB__element__dType_html"><div class="ttname"><a href="structDSPLIB__element__dType.html">DSPLIB_element_dType</a></div><div class="ttdef"><b>Definition:</b> <a href="TISP__DSPLIB__types_8hpp_source.html#l00035">TISP_DSPLIB_types.hpp:35</a></div></div>
</div><!-- fragment --> <h1><a class="anchor" id="connectingNodes"></a>
Connecting and Executing Nodes</h1>
<p>The data flow while connecting nodes is depicted through the pointer addresses shared between the nodes when creating a node through its class constructor. Whilst the compute flow is represented via the order in which the nodes are pushed back into <a class="el" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a>. Thus allowing us to create any given signal chain as a graph.</p>
<div class="image">
<object type="image/svg+xml" data="connecting_nodes.svg" width="500px" style="pointer-events: none;"></object>
<div class="caption">
Connecting Nodes</div></div>
<p>An example code snippet is shown below for connecting creating and connecting nodes together, taken from <a class="el" href="TISP__fft1dBatched__test_8cpp.html">TISP_fft1dBatched_test.cpp</a>. After creating nodes via constructors and pushing them back into <a class="el" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a> with the desired order, <a class="el" href="group__NODE.html#gae2eae7b6db00c00bdd1657f583c06486">TISP::execute::graph</a> can be called to iterate through the vector of nodes to call the execute function pertaining to a given node.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="keyword">auto</span> k0 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1FFTLIB_1_1fft1dBatched.html">TISP::FFTLIB::fft1dBatched&lt;float, TISP::NO_DMA&gt;</a>(pX0, pY0, numPoints, numChannels);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keyword">auto</span> k1 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1DSPLIB_1_1sqr.html">TISP::DSPLIB::sqr&lt;float, TISP::NO_DMA&gt;</a>(pY0, pY1, 2 * numPoints * numChannels);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a> myOpVec;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   myOpVec.push_back(k0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   myOpVec.push_back(k1);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="comment">/* k0-&gt;exec(); */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="comment">/* k1-&gt;exec(); */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   printf(<span class="stringliteral">&quot;\nExecuting graph\n&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#if (!HOST_EMULATION)</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   uint64_t startTime, endTime;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   startTime = (__get_GTSC(1), __STSC);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">for</span> (int32_t i = 0; i &lt; (<a class="code" href="TISP__fft1dBatched__test_8cpp.html#a0273a111e01d0dd3aefe71f8a2720f50">NUM_REPS</a>); i++) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="group__NODE.html#gae2eae7b6db00c00bdd1657f583c06486">TISP::execute::graph</a>(myOpVec);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#if (!HOST_EMULATION)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   endTime            = (__get_GTSC(1), __STSC);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   uint64_t totalTime = (endTime - startTime) / (<a class="code" href="TISP__fft1dBatched__test_8cpp.html#a0273a111e01d0dd3aefe71f8a2720f50">NUM_REPS</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   printf(<span class="stringliteral">&quot;Total cycles to execute graph = %llu\n&quot;</span>, totalTime);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   printf(<span class="stringliteral">&quot;\nTheoritical cycle count (assuming flat memory w/ no stalls): %d\n&quot;</span>, (<a class="code" href="TISP__fft1dBatched__test_8cpp.html#a962b51184548e2ffa90569e9d00fccb5">ESITMATED_TOTAL_CYCLE_COUNT</a>));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   printf(<span class="stringliteral">&quot;\nObeserved/Theoritical: %.2f\n&quot;</span>, (((<span class="keywordtype">float</span>) totalTime) / (<a class="code" href="TISP__fft1dBatched__test_8cpp.html#a962b51184548e2ffa90569e9d00fccb5">ESITMATED_TOTAL_CYCLE_COUNT</a>)));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="ttc" id="aTISP__fft1dBatched__test_8cpp_html_a0273a111e01d0dd3aefe71f8a2720f50"><div class="ttname"><a href="TISP__fft1dBatched__test_8cpp.html#a0273a111e01d0dd3aefe71f8a2720f50">NUM_REPS</a></div><div class="ttdeci">#define NUM_REPS</div><div class="ttdef"><b>Definition:</b> <a href="TISP__fft1dBatched__test_8cpp_source.html#l00023">TISP_fft1dBatched_test.cpp:23</a></div></div>
<div class="ttc" id="aTISP__fft1dBatched__test_8cpp_html_a962b51184548e2ffa90569e9d00fccb5"><div class="ttname"><a href="TISP__fft1dBatched__test_8cpp.html#a962b51184548e2ffa90569e9d00fccb5">ESITMATED_TOTAL_CYCLE_COUNT</a></div><div class="ttdeci">#define ESITMATED_TOTAL_CYCLE_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="TISP__fft1dBatched__test_8cpp_source.html#l00029">TISP_fft1dBatched_test.cpp:29</a></div></div>
<div class="ttc" id="aclassTISP_1_1DSPLIB_1_1sqr_html"><div class="ttname"><a href="classTISP_1_1DSPLIB_1_1sqr.html">TISP::DSPLIB::sqr</a></div><div class="ttdoc">Provides node-level APIs for the DSPLIB_sqr kernel from DSPLIB.</div><div class="ttdef"><b>Definition:</b> <a href="TISP__sqr_8hpp_source.html#l00023">TISP_sqr.hpp:23</a></div></div>
<div class="ttc" id="aclassTISP_1_1FFTLIB_1_1fft1dBatched_html"><div class="ttname"><a href="classTISP_1_1FFTLIB_1_1fft1dBatched.html">TISP::FFTLIB::fft1dBatched</a></div><div class="ttdoc">Provides node-level APIs for the FFTLIB_fft1dBatched kernel from DSPLIB. Assumes complex float data t...</div><div class="ttdef"><b>Definition:</b> <a href="TISP__fft1dBatched_8hpp_source.html#l00026">TISP_fft1dBatched.hpp:26</a></div></div>
<div class="ttc" id="agroup__NODE_html_gae2eae7b6db00c00bdd1657f583c06486"><div class="ttname"><a href="group__NODE.html#gae2eae7b6db00c00bdd1657f583c06486">TISP::execute::graph</a></div><div class="ttdeci">static void graph(const opVec &amp;myOpVec)</div><div class="ttdoc">This function takes in alias of the opeVec (list of nodes) and iterates through all the nodes calling...</div><div class="ttdef"><b>Definition:</b> <a href="TISP__util_8hpp_source.html#l00034">TISP_util.hpp:34</a></div></div>
<div class="ttc" id="anamespaceTISP_html_a12e676d8ee81f29cff2b09be9fa95c84"><div class="ttname"><a href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a></div><div class="ttdeci">std::vector&lt; virtualOp * &gt; opVec</div><div class="ttdef"><b>Definition:</b> <a href="TISP__virtualOp_8hpp_source.html#l00014">TISP_virtualOp.hpp:14</a></div></div>
</div><!-- fragment --> <h1><a class="anchor" id="superNodes"></a>
Supernode-level Abstraction</h1>
<p>We employ a similar strategy that was used to abstract nodes for supernodes as well. In the case of supernodes, we could have various variants such as <a class="el" href="classTISP_1_1SuperNode_1_1i2d__to__o2d.html">TISP::SuperNode::i2d_to_o2d</a>, <a class="el" href="classTISP_1_1SuperNode_1_1i2d__to__o2d.html">TISP::SuperNode::i2d_to_o2d</a>, etc. Further styles of supernodes will be added as we expand the scope of this library/framework. Note that variants of supernode are derived from a non-virtual base class <a class="el" href="classTISP_1_1SuperNode_1_1superNode.html">TISP::SuperNode::superNode</a>.</p>
<div class="image">
<object type="image/svg+xml" data="supernode-level_abstraction.svg" width="500px" style="pointer-events: none;"></object>
<div class="caption">
Supernode-Level Abstraction</div></div>
<p>An example code snippet for one input one output supernode is shown below. The DRU parameters are programmed to access the input and output DDR space in a 2D form.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> dTypeIn, <span class="keyword">typename</span> dTypeOut&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;i2d_to_o2d&lt;dTypeIn, dTypeOut&gt;::i2d_to_o2d(<a class="code" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">opVec</a>    &amp;_myOpVec,</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                                          dTypeIn  *_pIn,</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                                          dTypeOut *_pOut,</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                                          dTypeIn  *_pInBlock,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                                          dTypeOut *_pOutBlock,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                          <span class="keywordtype">size_t</span>    _width,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                                          <span class="keywordtype">size_t</span>    _height,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                          <span class="keywordtype">size_t</span>    _blockWidth,</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                                          <span class="keywordtype">size_t</span>    _blockHeight,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                                          <span class="keywordtype">size_t</span>    _inPitch,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                          <span class="keywordtype">size_t</span>    _outPitch,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                          <span class="keywordtype">size_t</span>    _numChannels)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    : superNode(_myOpVec, _numChannels, <a class="code" href="TISP__i2d__to__o2d_8cpp.html#aeb83ecc0378857567d8f035b49d4a43f">NUM_IN_CHANNELS</a>, <a class="code" href="TISP__i2d__to__o2d_8cpp.html#acccf723dbb454f9fe0f3b4f4fefa550b">NUM_OUT_CHANNELS</a>)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   int32_t retVal = UDMA_SOK;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   uint32_t transferSize = DMAUTILSAUTOINC3D_SYNC_2D;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">   /***********************/</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="comment">/* Configure input DMA */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">   /***********************/</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="comment">// set transfer dimenssion structure</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   dmaUtils&lt;dTypeIn&gt;::dmaAutoIncSetupXferPropIn2D(_width, _height, _blockWidth, _blockHeight, _inPitch, _outPitch,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                  &amp;transferDimIn);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="comment">// assign channel number</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   chIdIn[0] = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="comment">/* chIdIn[0] = dmaChOffset::globalChOffset; */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="comment">/* dmaChOffset::globalChOffset += 1; */</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="comment">// configure channel</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   retVal = dmaUtils&lt;dTypeIn&gt;::configure_channel(dmaUtilsContext, chIdIn[0], pTrMemCh, (uint8_t *) _pIn,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                 (uint8_t *) _pInBlock, transferSize, &amp;transferDimIn);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordflow">if</span> (retVal != UDMA_SOK) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      printf(<span class="stringliteral">&quot;[Error] UDMA init failed!!\n&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">   /***********************/</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="comment">/* Configure output DMA */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">   /***********************/</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="comment">// set transfer dimenssion structure</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   dmaUtils&lt;dTypeOut&gt;::dmaAutoIncSetupXferPropOut2D(_width, _height, _blockWidth, _blockHeight, _inPitch, _outPitch,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                    &amp;transferDimOut);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="comment">// assign channel number</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   chIdOut[0] = 1;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">/* chIdOut[0] = dmaChOffset::globalChOffset; */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="comment">/* dmaChOffset::globalChOffset += 1; */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="comment">// configure channel</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   retVal = dmaUtils&lt;dTypeOut&gt;::configure_channel(dmaUtilsContext, chIdOut[0], pTrMemCh, (uint8_t *) _pOutBlock,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                                  (uint8_t *) _pOut, transferSize, &amp;transferDimOut);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordflow">if</span> (retVal != UDMA_SOK) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      printf(<span class="stringliteral">&quot;[Error] UDMA init failed!!\n&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="ttc" id="aTISP__i2d__to__o2d_8cpp_html_acccf723dbb454f9fe0f3b4f4fefa550b"><div class="ttname"><a href="TISP__i2d__to__o2d_8cpp.html#acccf723dbb454f9fe0f3b4f4fefa550b">NUM_OUT_CHANNELS</a></div><div class="ttdeci">#define NUM_OUT_CHANNELS</div><div class="ttdef"><b>Definition:</b> <a href="TISP__i2d__to__o2d_8cpp_source.html#l00008">TISP_i2d_to_o2d.cpp:8</a></div></div>
<div class="ttc" id="aTISP__i2d__to__o2d_8cpp_html_aeb83ecc0378857567d8f035b49d4a43f"><div class="ttname"><a href="TISP__i2d__to__o2d_8cpp.html#aeb83ecc0378857567d8f035b49d4a43f">NUM_IN_CHANNELS</a></div><div class="ttdeci">#define NUM_IN_CHANNELS</div><div class="ttdef"><b>Definition:</b> <a href="TISP__i2d__to__o2d_8cpp_source.html#l00007">TISP_i2d_to_o2d.cpp:7</a></div></div>
</div><!-- fragment --> <h1><a class="anchor" id="connectingSuperNodes"></a>
Connecting and Executing Supernodes</h1>
<p>Connecting and execution supernodes is also similar to nodes. The execution order of the kernels inside the supernode is determined by the <a class="el" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a> datastructure passed to the supernode constructor as argument.</p>
<div class="image">
<object type="image/svg+xml" data="connecting_supernodes.svg" width="1000px" style="pointer-events: none;"></object>
<div class="caption">
Connecting Supernodes</div></div>
<p>Please refer to 2D FFT example section below for more details.</p>
<h1><a class="anchor" id="fft2d"></a>
2D FFT Example</h1>
<p>The example has two supernodes connected together as shown in the figure below. </p><div class="image">
<object type="image/svg+xml" data="2dfft.svg" width="1000px" style="pointer-events: none;"></object>
<div class="caption">
2D FFT Example</div></div>
<p> Shown below is the code snippet that depicts the 2D FFT graph. The code snippet is taken from <a class="el" href="TISP__fft2d__superNode__test_8cpp.html">TISP_fft2d_superNode_test.cpp</a>. </p><div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keyword">auto</span> k0 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1FFTLIB_1_1fft1dBatched.html">TISP::FFTLIB::fft1dBatched&lt;float, TISP::DMA_IN&gt;</a>(pInputBlock, pTempBlock, numPoints, blockHeight);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keyword">auto</span> k1 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1DSPLIB_1_1matTrans.html">TISP::DSPLIB::matTrans&lt;double, TISP::DMA_OUT&gt;</a>(</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       (<span class="keywordtype">double</span> *) pTempBlock, (<span class="keywordtype">double</span> *) pOutputBlock, blockWidth &gt;&gt; 1, blockHeight, blockWidth * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) &gt;&gt; 1,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       blockHeight * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <a class="code" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a> myOpVec0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   myOpVec0.push_back(k0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   myOpVec0.push_back(k1);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="keyword">auto</span> s0 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1SuperNode_1_1i2d__to__o2dTranspose.html">TISP::SuperNode::i2d_to_o2dTranspose&lt;double, double&gt;</a>(</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;       myOpVec0, (<span class="keywordtype">double</span> *) input, (<span class="keywordtype">double</span> *) output, (<span class="keywordtype">double</span> *) pInputBlock, (<span class="keywordtype">double</span> *) pOutputBlock, numPoints,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;       numChannels, blockWidth &gt;&gt; 1, blockHeight, (numPoints) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), numChannels * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       (<a class="code" href="TISP__fft2d__superNode__test_8cpp.html#af735330464f703ba17ace5e7e08a8804">TOTAL_DMA_CHANNELS</a>));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keyword">auto</span> k2 =</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;       <span class="keyword">new</span> <a class="code" href="classTISP_1_1FFTLIB_1_1fft1dBatched.html">TISP::FFTLIB::fft1dBatched&lt;float, TISP::DMA_IN_OUT&gt;</a>(pInputBlock, pOutputBlock, numChannels, blockHeight);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <a class="code" href="namespaceTISP.html#a12e676d8ee81f29cff2b09be9fa95c84">TISP::opVec</a> myOpVec1;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   myOpVec1.push_back(k2);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keyword">auto</span> s1 = <span class="keyword">new</span> <a class="code" href="classTISP_1_1SuperNode_1_1i2d__to__o2d.html">TISP::SuperNode::i2d_to_o2d&lt;float, float&gt;</a>(</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;       myOpVec1, output, input, pInputBlock, pOutputBlock, numChannels &lt;&lt; 1, numPoints, numChannels &lt;&lt; 1, blockHeight,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       (numChannels &lt;&lt; 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), (numChannels &lt;&lt; 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), (<a class="code" href="TISP__fft2d__superNode__test_8cpp.html#af735330464f703ba17ace5e7e08a8804">TOTAL_DMA_CHANNELS</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="namespaceTISP_1_1SuperNode.html#a34b5735c89eb8bd230092d05d544cbd4">TISP::SuperNode::superNodeVec</a> mySuperNodeVec;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   mySuperNodeVec.push_back(s0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   mySuperNodeVec.push_back(s1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   printf(<span class="stringliteral">&quot;\nExecuting Graph\n&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#if (!HOST_EMULATION)</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   uint64_t startTime, endTime;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   startTime = (__get_GTSC(1), __STSC);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <a class="code" href="group__NODE.html#gae2eae7b6db00c00bdd1657f583c06486">TISP::execute::graph</a>(mySuperNodeVec);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="ttc" id="aTISP__fft2d__superNode__test_8cpp_html_af735330464f703ba17ace5e7e08a8804"><div class="ttname"><a href="TISP__fft2d__superNode__test_8cpp.html#af735330464f703ba17ace5e7e08a8804">TOTAL_DMA_CHANNELS</a></div><div class="ttdeci">#define TOTAL_DMA_CHANNELS</div><div class="ttdef"><b>Definition:</b> <a href="TISP__fft2d__superNode__test_8cpp_source.html#l00027">TISP_fft2d_superNode_test.cpp:27</a></div></div>
<div class="ttc" id="aclassTISP_1_1DSPLIB_1_1matTrans_html"><div class="ttname"><a href="classTISP_1_1DSPLIB_1_1matTrans.html">TISP::DSPLIB::matTrans</a></div><div class="ttdoc">Provides node-level APIs for the DSPLIB_matTrans kernel from DSPLIB.</div><div class="ttdef"><b>Definition:</b> <a href="TISP__matTrans_8hpp_source.html#l00023">TISP_matTrans.hpp:23</a></div></div>
<div class="ttc" id="aclassTISP_1_1SuperNode_1_1i2d__to__o2dTranspose_html"><div class="ttname"><a href="classTISP_1_1SuperNode_1_1i2d__to__o2dTranspose.html">TISP::SuperNode::i2d_to_o2dTranspose</a></div><div class="ttdoc">Provides the supernode style when input data is transferred in 2D form and output blocks are transfer...</div><div class="ttdef"><b>Definition:</b> <a href="TISP__superNode_8hpp_source.html#l00163">TISP_superNode.hpp:163</a></div></div>
<div class="ttc" id="aclassTISP_1_1SuperNode_1_1i2d__to__o2d_html"><div class="ttname"><a href="classTISP_1_1SuperNode_1_1i2d__to__o2d.html">TISP::SuperNode::i2d_to_o2d</a></div><div class="ttdoc">Provides the supernode style when input data is transferred in 2D form and output is transferred out ...</div><div class="ttdef"><b>Definition:</b> <a href="TISP__superNode_8hpp_source.html#l00109">TISP_superNode.hpp:109</a></div></div>
<div class="ttc" id="anamespaceTISP_1_1SuperNode_html_a34b5735c89eb8bd230092d05d544cbd4"><div class="ttname"><a href="namespaceTISP_1_1SuperNode.html#a34b5735c89eb8bd230092d05d544cbd4">TISP::SuperNode::superNodeVec</a></div><div class="ttdeci">std::vector&lt; TISP::SuperNode::superNode * &gt; superNodeVec</div><div class="ttdef"><b>Definition:</b> <a href="TISP__superNode_8hpp_source.html#l00094">TISP_superNode.hpp:94</a></div></div>
</div><!-- fragment --> <dl class="section user"><dt>Disclaimer</dt><dd></dd></dl>
<p>See also <a class="el" href="TI_DISCLAIMER.html">TI Disclaimer</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
